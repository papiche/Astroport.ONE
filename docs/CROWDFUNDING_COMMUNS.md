# ğŸŒ³ SystÃ¨me de Crowdfunding des Communs

## Vue d'ensemble

Le systÃ¨me de **Crowdfunding des Communs** permet de gÃ©rer l'acquisition collective de biens Ã  transfÃ©rer en gestion collective : terrains, forÃªts jardins, espaces de permaculture, locaux, Ã©quipements partagÃ©s, etc.

Le systÃ¨me gÃ¨re **plusieurs propriÃ©taires ayant des intentions diffÃ©rentes** :

### Deux modes de sortie pour les propriÃ©taires

| Mode | Symbole | Destination | Convertible â‚¬ | Avantages |
|------|---------|-------------|---------------|-----------|
| **COMMONS** | ğŸ¤ | UPLANETNAME_CAPITAL | âŒ Non | AccÃ¨s Ã  tous les lieux UPlanet áºEN |
| **CASH** | ğŸ’¶ | Paiement â‚¬ depuis ASSETS | âœ… Oui | LiquiditÃ© immÃ©diate |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAS D'USAGE : BIEN COMMUN                                â”‚
â”‚                    2 propriÃ©taires, 1 mÃªme armature                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

     PROPRIÃ‰TAIRE A                              PROPRIÃ‰TAIRE B
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     ğŸ¤ Mode COMMONS                            ğŸ’¶ Mode CASH
     Donation non-â‚¬                             Vente en â‚¬
           â”‚                                          â”‚
           â–¼                                          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ UPLANETNAME   â”‚                        â”‚   ASSETS      â”‚
   â”‚   CAPITAL     â”‚                        â”‚   (liquide)   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                        â”‚
           â”‚                                        â”‚
           â–¼                                        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Si ASSETS insuffisant â†’ CROWDFUNDING "áº conv. â‚¬"   â”‚
   â”‚   Si UPLANETNAME_G1 < seuil â†’ CAMPAGNE DON Ä1        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Types de biens Ã©ligibles

Le Crowdfunding des Communs peut financer :

| CatÃ©gorie | Exemples | CaractÃ©ristiques |
|-----------|----------|------------------|
| **ğŸŒ³ Terrains naturels** | ForÃªts jardins, zones de permaculture, prairies | Usage collectif long terme |
| **ğŸ  Immobilier** | Locaux associatifs, ateliers partagÃ©s, habitats groupÃ©s | Infrastructure commune |
| **ğŸ”§ Ã‰quipements** | Machines-outils, vÃ©hicules, matÃ©riel agricole | Mutualisation des ressources |
| **ğŸ’» NumÃ©rique** | Serveurs, nÅ“uds IPFS, stations Astroport | Infrastructure rÃ©seau |
| **ğŸ¨ Culturel** | Å’uvres d'art, archives, patrimoine | PrÃ©servation collective |

---

## Architecture des Portefeuilles

### Portefeuilles impliquÃ©s

| Portefeuille | Fichier | RÃ´le dans le crowdfunding |
|--------------|---------|---------------------------|
| **UPLANETNAME_G1** | `~/.zen/tmp/UPLANETNAME_G1` | Source Ä1 initiale, rÃ©appro si campagne |
| **UPLANETNAME_CAPITAL** | `uplanet.CAPITAL.dunikey` | ReÃ§oit les donations Commons (non-convertible â‚¬) |
| **ASSETS** | `uplanet.ASSETS.dunikey` | Source pour paiements Cash (convertible â‚¬) |
| **CASH** | `uplanet.CASH.dunikey` | RÃ©serve de trÃ©sorerie |

### Flux financiers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FLUX FINANCIERS                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   CROWDFUNDING      â”‚
                    â”‚   Contributions     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                    â”‚                    â”‚
          â–¼                    â–¼                    â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Don Ä1      â”‚      â”‚ áºen conv.â‚¬  â”‚      â”‚ áºen non-â‚¬   â”‚
   â”‚ (June)      â”‚      â”‚ (LiquiditÃ©) â”‚      â”‚ (Communs)   â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚                    â”‚                    â”‚
          â–¼                    â–¼                    â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ UPLANETNAME â”‚      â”‚   ASSETS    â”‚      â”‚   CAPITAL   â”‚
   â”‚     _G1     â”‚      â”‚             â”‚      â”‚             â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚ PAIEMENT â‚¬  â”‚
                       â”‚ PropriÃ©taireâ”‚
                       â”‚   CASH      â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” IdentitÃ© du Bien (Bien Identity)

### Concept

Chaque projet crowdfunding ("Bien") possÃ¨de **sa propre identitÃ© NOSTR et son propre wallet Ä1**. Cela permet au Bien de :

1. **Recevoir des contributions +ZEN** directement via les rÃ©actions Nostr (kind 7)
2. **Publier des mises Ã  jour** sur la campagne depuis son propre compte
3. **Avoir une traÃ§abilitÃ© complÃ¨te** des contributions sur la blockchain

### DÃ©rivation des clÃ©s

Les clÃ©s du Bien sont **dÃ©terministes**, dÃ©rivÃ©es des coordonnÃ©es UMAP et de l'ID du projet :

```
BIEN_SALT   = ${UPLANETNAME}${LAT}_${PROJECT_ID}
BIEN_PEPPER = ${UPLANETNAME}${LON}_${PROJECT_ID}

Exemple:
  UPLANETNAME = "AstroGEMS"
  LAT = 43.60
  LON = 1.44
  PROJECT_ID = CF-20250122-A1B2

  BIEN_SALT   = "AstroGEMS43.60_CF-20250122-A1B2"
  BIEN_PEPPER = "AstroGEMS1.44_CF-20250122-A1B2"
```

### ClÃ©s gÃ©nÃ©rÃ©es

| Type | Outil | Usage |
|------|-------|-------|
| **NOSTR npub** | `keygen -t nostr SALT PEPPER` | IdentitÃ© publique du Bien |
| **NOSTR nsec** | `keygen -t nostr SALT PEPPER -s` | Signature des publications |
| **NOSTR hex** | `nostr2hex.py NPUB` | Tag `["p", HEX]` pour rÃ©actions |
| **Ä1 wallet** | `keygen -t duniter SALT PEPPER` | RÃ©ception des contributions |

### Fichiers gÃ©nÃ©rÃ©s

```
~/.zen/game/crowdfunding/{PROJECT_ID}/
â”œâ”€â”€ project.json           # MÃ©tadonnÃ©es du projet (inclut bien_identity)
â”œâ”€â”€ bien.pubkeys           # ClÃ©s publiques (NPUB, HEX, G1PUB)
â”œâ”€â”€ bien.dunikey           # Wallet Ä1 (chmod 600)
â””â”€â”€ .bien.nostr            # Secret NOSTR (chmod 600)
```

### Commandes associÃ©es

```bash
# Les clÃ©s sont gÃ©nÃ©rÃ©es automatiquement Ã  la crÃ©ation
./CROWDFUNDING.sh create 43.60 1.44 "Mon Projet" "Description"

# Publier le profil NOSTR du Bien
./CROWDFUNDING.sh publish-profile CF-20250122-XXXX

# RÃ©gÃ©nÃ©rer les clÃ©s (mÃªme rÃ©sultat car dÃ©terministe)
./CROWDFUNDING.sh regenerate-keys CF-20250122-XXXX

# VÃ©rifier le solde du wallet du Bien
./CROWDFUNDING.sh bien-balance CF-20250122-XXXX
```

### RÃ©ception des +ZEN

Les contributeurs envoient des +ZEN via les rÃ©actions Nostr (kind 7) en tagant le Bien :

```json
{
  "kind": 7,
  "content": "+50",
  "tags": [
    ["p", "BIEN_HEX_PUBKEY"],
    ["t", "crowdfunding"],
    ["t", "UPlanet"],
    ["project-id", "CF-20250122-XXXX"]
  ]
}
```

Le filtre `7.sh` dÃ©tecte ces rÃ©actions et :
1. Valide le solde du contributeur
2. ExÃ©cute le transfert Ä1 vers le wallet du Bien
3. Met Ã  jour les totaux du projet

---

## Interface CLI

### Installation

```bash
chmod +x ~/.zen/Astroport.ONE/tools/CROWDFUNDING.sh
```

### Commandes disponibles

```bash
# CrÃ©er un nouveau projet (gÃ©nÃ¨re automatiquement l'identitÃ© du Bien)
./CROWDFUNDING.sh create LAT LON "NOM_PROJET" "DESCRIPTION"

# Publier le profil NOSTR du Bien
./CROWDFUNDING.sh publish-profile PROJECT_ID

# RÃ©gÃ©nÃ©rer les clÃ©s du Bien (rÃ©sultat identique car dÃ©terministe)
./CROWDFUNDING.sh regenerate-keys PROJECT_ID

# Ajouter des propriÃ©taires
./CROWDFUNDING.sh add-owner PROJECT_ID EMAIL commons 500  # Donation áºen
./CROWDFUNDING.sh add-owner PROJECT_ID EMAIL cash 1000    # Vente â‚¬ (dÃ©clenche vote ASSETS)

# Voir le statut (inclut identitÃ© du Bien et solde)
./CROWDFUNDING.sh status PROJECT_ID

# VÃ©rifier le solde du wallet du Bien
./CROWDFUNDING.sh bien-balance PROJECT_ID

# Enregistrer une contribution
./CROWDFUNDING.sh contribute PROJECT_ID EMAIL AMOUNT CURRENCY

# Voter pour utilisation des fonds ASSETS
./CROWDFUNDING.sh vote PROJECT_ID VOTER_PUBKEY AMOUNT
./CROWDFUNDING.sh vote-status PROJECT_ID

# Finaliser (exÃ©cuter les transferts)
./CROWDFUNDING.sh finalize PROJECT_ID

# Lister les projets
./CROWDFUNDING.sh list --active
./CROWDFUNDING.sh list --completed
./CROWDFUNDING.sh list --all

# Dashboard interactif
./CROWDFUNDING.sh dashboard
```

### Exemple complet

```bash
# 1. CrÃ©er le projet "Atelier PartagÃ©"
./CROWDFUNDING.sh create 43.6047 1.4442 "Atelier PartagÃ©" "Local de fabrication collaborative"
# Output: CF-20250122-A1B2C3D4
# â†’ GÃ©nÃ¨re automatiquement l'identitÃ© NOSTR et le wallet Ä1 du Bien
# â†’ Affiche: NOSTR npub, hex, et Ä1 wallet

# 2. Publier le profil NOSTR du Bien
./CROWDFUNDING.sh publish-profile CF-20250122-A1B2C3D4
# â†’ Le Bien devient visible sur NOSTR avec son profil
# â†’ Peut recevoir des +ZEN via les rÃ©actions kind 7

# 3. Ajouter Alice (donation aux Communs)
./CROWDFUNDING.sh add-owner CF-20250122-A1B2C3D4 alice@example.com commons 500
# â†’ 500 áºen iront vers UPLANETNAME_CAPITAL (non-convertible â‚¬)
# â†’ Alice recevra accÃ¨s Ã  tous les lieux UPlanet áºEN

# 4. Ajouter Bob (vente en â‚¬)
./CROWDFUNDING.sh add-owner CF-20250122-A1B2C3D4 bob@example.com cash 1000
# â†’ Si ASSETS suffisant â†’ Lance vote des sociÃ©taires (status: vote_pending)
# â†’ Si ASSETS insuffisant â†’ Lance crowdfunding "áº convertible â‚¬"
# â†’ Si UPLANETNAME_G1 < 10000 Ä1 â†’ Lance campagne don Ä1

# 5. VÃ©rifier le statut du vote (si applicable)
./CROWDFUNDING.sh vote-status CF-20250122-A1B2C3D4
# â†’ Affiche: progression du vote, quorum, seuil

# 6. VÃ©rifier le statut complet
./CROWDFUNDING.sh status CF-20250122-A1B2C3D4
# â†’ Affiche: identitÃ© du Bien, solde, propriÃ©taires, campagnes

# 7. VÃ©rifier les contributions reÃ§ues par le Bien
./CROWDFUNDING.sh bien-balance CF-20250122-A1B2C3D4
# â†’ Affiche le solde du wallet Ä1 du Bien

# 8. AprÃ¨s vote approuvÃ©, finaliser
./CROWDFUNDING.sh finalize CF-20250122-A1B2C3D4
# â†’ ExÃ©cute tous les transferts blockchain
```

---

## Interface Web

### AccÃ¨s

```
https://[IPFS_GATEWAY]/ipns/copylaradio.com/crowdfunding.html
```

ou via l'application nostr.html :
```
Bouton ğŸŒ³ dans la barre supÃ©rieure â†’ Crowdfunding des Communs
```

### FonctionnalitÃ©s

| Section | Description |
|---------|-------------|
| **Dashboard** | Vue d'ensemble des campagnes et stats |
| **Projets actifs** | Liste des crowdfundings en cours |
| **CrÃ©er projet** | Formulaire de crÃ©ation avec propriÃ©taires |
| **Contribuer** | Modal avec QR code et adresse wallet |

---

## Structure des donnÃ©es

### Projet (JSON)

```json
{
    "id": "CF-20250122-A1B2C3D4",
    "name": "Atelier PartagÃ©",
    "description": "Local de fabrication collaborative",
    "location": {
        "latitude": 43.6047,
        "longitude": 1.4442
    },
    "umap_id": "UMAP_43.60_1.44",
    "bien_identity": {
        "npub": "npub1xxx...xxx",
        "hex": "abc123...def",
        "g1pub": "GfCHe...xyz",
        "derivation": {
            "salt": "AstroGEMS43.6047_CF-20250122-A1B2C3D4",
            "pepper": "AstroGEMS1.4442_CF-20250122-A1B2C3D4"
        }
    },
    "bien_profile_published": true,
    "status": "crowdfunding",
    "owners": [
        {
            "email": "alice@example.com",
            "mode": "commons",
            "amount_zen": 500,
            "amount_eur": 0,
            "status": "pending"
        },
        {
            "email": "bob@example.com",
            "mode": "cash",
            "amount_zen": 0,
            "amount_eur": 1000,
            "status": "pending"
        }
    ],
    "vote": {
        "assets_vote_active": true,
        "assets_amount_zen": 1000,
        "vote_threshold": 100,
        "vote_quorum": 10,
        "votes_zen_total": 75,
        "voters_count": 8,
        "vote_status": "pending"
    },
    "totals": {
        "commons_zen": 500,
        "cash_eur": 1000,
        "zen_convertible_target": 1000,
        "zen_convertible_collected": 250,
        "g1_target": 150,
        "g1_collected": 45
    },
    "campaigns": {
        "zen_convertible_campaign_active": true,
        "g1_campaign_active": true
    },
    "contributions": [
        {
            "contributor_email": "charlie@example.com",
            "amount": 100,
            "currency": "ZEN",
            "timestamp": "2025-01-22T10:30:00Z"
        }
    ]
}
```

### Publication Nostr (kind 30023)

Les campagnes sont publiÃ©es sur Nostr pour visibilitÃ© :

```json
{
    "kind": 30023,
    "tags": [
        ["d", "crowdfunding-CF-20250120-A1B2C3D4"],
        ["title", "ğŸŒ³ Crowdfunding: Atelier PartagÃ©"],
        ["t", "crowdfunding"],
        ["t", "UPlanet"],
        ["t", "commons"],
        ["g", "43.6047,1.4442"],
        ["project-id", "CF-20250120-A1B2C3D4"]
    ],
    "content": "# ğŸŒ³ Atelier PartagÃ©\n\n..."
}
```

---

## SystÃ¨me de Vote ASSETS

### Principe

L'utilisation des fonds ASSETS pour les rachats cash **n'est pas automatique**. Elle nÃ©cessite un **vote des sociÃ©taires**.

Les sociÃ©taires votent en envoyant des rÃ©actions Nostr (+áºen) avec le tag `vote-assets`.

### Conditions de validation

| CritÃ¨re | Seuil par dÃ©faut | Description |
|---------|------------------|-------------|
| **Seuil áºen** | 100 áºen | Total des votes en áºen |
| **Quorum** | 10 votants | Nombre minimum de votants |

Le vote passe **uniquement** si les deux conditions sont remplies.

### Comment voter

Via l'interface web `crowdfunding.html` :
- Bouton ğŸ—³ï¸ "Voter (+áºen)" sur les projets en attente de vote
- Choisir le poids du vote (1, 5, 10, 20 áºen)

Via Nostr directement :
```json
{
    "kind": 7,
    "content": "+1",  // ou "+5", "+10", etc.
    "tags": [
        ["t", "vote-assets"],
        ["project-id", "CF-XXXXXXXX"],
        ["vote-type", "ASSETS_USAGE"]
    ]
}
```

Via CLI :
```bash
./CROWDFUNDING.sh vote CF-20250120-XXXX VOTER_PUBKEY 5
./CROWDFUNDING.sh vote-status CF-20250120-XXXX
```

### Flux de dÃ©cision

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUX DE VOTE ASSETS                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  PropriÃ©taire CASH ajoutÃ©
           â”‚
           â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ASSETS suffisantâ”‚â”€â”€â”€â”€ NON â”€â”€â”€â”€â–º Crowdfunding "áºen conv. â‚¬"
  â”‚   pour couvrir? â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ OUI
           â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ğŸ—³ï¸ VOTE LANCÃ‰   â”‚
  â”‚ Statut: pending â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ SociÃ©taires votent +áºen
           â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Seuil áºen atteint?              â”‚
  â”‚ Quorum votants atteint?         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
       â”‚               â”‚
    OUI + OUI       NON (un des deux)
       â”‚               â”‚
       â–¼               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ âœ… APPROUVÃ‰â”‚   â”‚ â³ EN ATTENTE  â”‚
  â”‚ â†’ finalize â”‚   â”‚ (plus de votes)â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## DÃ©clencheurs automatiques

### Vote ASSETS (nouveau)

**Condition :** `CASH_EUR_NEEDED > 0 AND ASSETS_BALANCE >= CASH_EUR_NEEDED`

```bash
# Si les fonds ASSETS peuvent couvrir les besoins cash
# Un vote est lancÃ© au lieu d'utiliser automatiquement les fonds
jq ".vote = {
    \"assets_vote_active\": true,
    \"assets_amount_zen\": $zen_from_assets,
    \"vote_threshold\": $ASSETS_VOTE_THRESHOLD,
    \"vote_quorum\": $ASSETS_VOTE_QUORUM,
    \"vote_status\": \"pending\"
}" "$project_file"
```

### Campagne "áºen convertible â‚¬"

**Condition :** `ASSETS_BALANCE < CASH_EUR_NEEDED`

```bash
# Si ASSETS insuffisant â†’ crowdfunding (pas de vote possible)
if [[ $(echo "$g1_for_cash > $assets_balance" | bc -l) -eq 1 ]]; then
    zen_shortfall=$(echo "scale=2; ($g1_for_cash - $assets_balance) * 10" | bc -l)
    # Lance campagne áºen convertible â‚¬
fi
```

### Campagne "Don Ä1"

**Condition :** `UPLANETNAME_G1 < G1_LOW_THRESHOLD (100 Ä1 par dÃ©faut)`

```bash
# VÃ©rification automatique
G1_LOW_THRESHOLD=100
if [[ $(echo "$g1_balance < $G1_LOW_THRESHOLD" | bc -l) -eq 1 ]]; then
    # Lance campagne don Ä1
fi
```

---

## RÃ©fÃ©rences blockchain

Format des commentaires de transaction :

| Type | Format | Exemple |
|------|--------|---------|
| **Contribution áºen** | `CF:{PROJECT_ID}:ZEN` | `CF:CF-20250120-A1B2:ZEN` |
| **Contribution Ä1** | `CF:{PROJECT_ID}:G1` | `CF:CF-20250120-A1B2:G1` |
| **Commons out** | `UPLANET:{PUBKEY8}:COMMONS:{EMAIL}:{PROJECT_ID}:{IPFSNODEID}` | ... |
| **Cash out** | `UPLANET:{PUBKEY8}:CASHOUT:{EMAIL}:{PROJECT_ID}:{IPFSNODEID}` | ... |

---

## IntÃ©gration avec le systÃ¨me existant

### Lien avec UPLANET.official.sh

```bash
# Le crowdfunding utilise les mÃªmes mÃ©canismes que UPLANET.official.sh
# pour les transferts finaux :

# Commons â†’ CAPITAL (mÃªme logique que infrastructure)
./UPLANET.official.sh -i --add  # Ajoute au capital existant

# Cash â†’ ASSETS â†’ PropriÃ©taire
./PAYforSURE.sh uplanet.ASSETS.dunikey MONTANT WALLET REFERENCE
```

### Mise Ã  jour DID

AprÃ¨s finalisation, les DID des propriÃ©taires sont mis Ã  jour :

```bash
# Pour donation Commons
./did_manager_nostr.sh update EMAIL "COMMONS_CONTRIBUTION" MONTANT_ZEN MONTANT_G1

# Pour rÃ©ception Cash
# (Pas de mise Ã  jour DID spÃ©cifique, juste transaction blockchain)
```

---

## ConformitÃ© lÃ©gale

### ModÃ¨le Ã©conomique

Ce systÃ¨me respecte le modÃ¨le coopÃ©ratif UPlanet :

1. **Donations Commons** : Non-convertibles â‚¬, crÃ©ent des droits d'usage partagÃ©s
2. **Ventes Cash** : NÃ©cessitent liquiditÃ© rÃ©elle, traÃ§abilitÃ© blockchain
3. **Crowdfunding** : Financement participatif avec transparence totale

### TraÃ§abilitÃ©

Toutes les transactions sont enregistrÃ©es :
- Sur la blockchain Ä1 (Duniter)
- Sur Nostr (Ã©vÃ©nements kind 30023)
- Dans les fichiers locaux (`~/.zen/game/crowdfunding/`)

---

## Liens utiles

- **CLI** : `Astroport.ONE/tools/CROWDFUNDING.sh`
- **Web** : `UPlanet/earth/crowdfunding.html`
- **Docs** : `Astroport.ONE/docs/CROWDFUNDING_COMMUNS.md`
- **Contract** : `Astroport.ONE/docs/UPlanet_CROWDFUNDING_CONTRACT.md`
- **321 DU** : `Astroport.ONE/321_DU.md` (systÃ¨me de vÅ“ux connexe)
- **UPLANET.official.sh** : `Astroport.ONE/UPLANET.official.sh`

---

*Documentation du systÃ¨me de Crowdfunding des Communs - UPlanet áºEN*
