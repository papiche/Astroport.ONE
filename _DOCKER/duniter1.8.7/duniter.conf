# Fail2ban filter for Duniter Docker container
# Detects HTTP requests to Duniter services

[Definition]
# Fail regex patterns for Duniter requests
failregex = ^.*"GET /.* HTTP/.*" [4-5][0-9][0-9] .*$
            ^.*"POST /.* HTTP/.*" [4-5][0-9][0-9] .*$
            ^.*"PUT /.* HTTP/.*" [4-5][0-9][0-9] .*$
            ^.*"DELETE /.* HTTP/.*" [4-5][0-9][0-9] .*$
            ^.*"HEAD /.* HTTP/.*" [4-5][0-9][0-9] .*$
            ^.*"OPTIONS /.* HTTP/.*" [4-5][0-9][0-9] .*$
            ^.*"PATCH /.* HTTP/.*" [4-5][0-9][0-9] .*$
            ^.*"TRACE /.* HTTP/.*" [4-5][0-9][0-9] .*$
            ^.*"CONNECT /.* HTTP/.*" [4-5][0-9][0-9] .*$

# Ignore regex patterns (successful requests and health checks)
ignoreregex = ^.*"GET /health HTTP/.*" 200 .*$
              ^.*"GET /ping HTTP/.*" 200 .*$
              ^.*"GET /status HTTP/.*" 200 .*$
              ^.*"GET /metrics HTTP/.*" 200 .*$
              ^.*"GET /favicon.ico HTTP/.*" 200 .*$
              ^.*"GET /robots.txt HTTP/.*" 200 .*$
              ^.*"GET /.* HTTP/.*" 200 .*$
              ^.*"POST /.* HTTP/.*" 200 .*$
              ^.*"PUT /.* HTTP/.*" 200 .*$
              ^.*"DELETE /.* HTTP/.*" 200 .*$
              ^.*"HEAD /.* HTTP/.*" 200 .*$
              ^.*"OPTIONS /.* HTTP/.*" 200 .*$
              ^.*"PATCH /.* HTTP/.*" 200 .*$
              ^.*"TRACE /.* HTTP/.*" 200 .*$
              ^.*"CONNECT /.* HTTP/.*" 200 .*$ 